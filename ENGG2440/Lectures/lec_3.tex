\chapter{Recurrences}

Sometimes recurrences are closely related to sums. Thus, if we are going to find the closed-form formula, we can express the sum as a recurrence, then the problem will be comparatively easier.

\section{Homogeneous Recurrences}
\begin{definition}[Linear homogeneous recurrence]
    A linear homogeneous recurrence relation of degree \(d\) with constant coefficients is a recurrence relation of the form
    \[
        T(n) = a_1 T(n-1) + a_2 T(n-2) + \cdots + a_d T(n-d) ,
    \]
    where \(a_1, a_2, \cdots, a_k \in \mathbb{R}\) are given constants and \(a_k \neq  0\) 
\end{definition}

To solve for homogeneous recurrences with distinct root, we can use the following procedure:

1. Solve the characteristic equation to get root \(r_1, \cdots, r_d\).

2. If the roots are all distinct, form, the candidate solution
\[
    T_0(n) = \theta_1 r_1^n + \theta_2 r_2^n + \cdots + \theta_d r_d^n
\]

3. Use the initial conditions on \(T(1), \dots, T(d)\) to determine \(\theta_1, \dots, \theta_d\) 

\begin{eg}
    \[
        \begin{dcases}
            T(n) = T(n - 1) + 2T(n - 2)\quad\text{for \(n \leq  2\) }\\
            T(0) = 2, T(1) = 7
        \end{dcases}
    \]
    Let \(T(n) = x^n\). Then, for characteristic equation, we have
    \[
    \begin{aligned}
        x^n &= x^{n-1} + 2x^{n-2} \\
        x^2 &= x + 2 \quad \text{(characteristic equation)}
    \end{aligned}
    \]
    The roots are \(r_1 = 2, r_2 = -1\). Since they are distinct, we can form the candidate solution
    \[
        T_0(n) = \theta_1 2^n + \theta_2 (-1)^n.
    \]
    By using the initial conditions, we have
    \[
        \begin{aligned}
            2 &= T_0(0) = \theta_1 + \theta_2 \\
            7 &= T_0(1) = 2\theta_1 - \theta_2
        \end{aligned}
    \]
    Solving above, we have \(\theta_1 = 3, \theta_ = -1\). Then, we have
    \[
        T(n) = 3 \times 2^n - (-1)^n
    \] 
\end{eg}

However, if the root of the characteristic equation has a multiplicity \(m \leq 1\), i.e., the root is repeated for \(m\)  times, then we have \(T(n) = n^{m-1}x^n\). Yet the procedure are the same as solving linear homogeneous recurrence with distinct roots. 

\begin{eg}
    \[
        \begin{dcases}
            T(n) = 2T(n - 1) - T(n - 2)\quad\text{for} n \geq 2,\\
            T(0) = 0, T(1) = 1\\
        \end{dcases}
    \]
    Characteristic equation: \(x^2 = 2x - 1\). 

    Solving above we have \(r_1 = 1\) with multiplicity \(m_1 = 2\).
    Then we have
    \[
        T_0(n) = \theta_1 (1)^n + n\theta_2(1)^n = \theta_1+ n\theta_2
    \]
    By using initial conditions, we have
    \[
        \begin{aligned}
            0 &= T_0(0) = \theta \\
            1 &= T_0(1) = \theta_1 + \theta_2
        \end{aligned}
    \]
    Then, it follows that the solution to the recurrences is given by
    \[
        T(n) = n
    \]
\end{eg}

Let's see another example
\begin{eg}
\[
    \begin{dcases}
        T(n) = 4T(n-1) - 5T(n-2) + 2T(n-3)\quad\text{for} n\geq 3,\\
        T(0) = 0, T(1) = 1, T(2) = 3.
    \end{dcases}
\]
Characteristic equation: \(x^3 = 4x^2 - 5x + 2\) 

This equation has two distinct roots, \(r_1 = 1, r_2 = 2\). The multiplicity of \(r_1\) is \(m_1 = 2\). Hence,
\[
    T_0(n) = \theta_1 (1)^n + n\theta_2 (1)^n + \theta_3 2^n = \theta_1 + n\theta_2 + \theta_3 2^n
\]
Using initial conditions, we have
\[
    \begin{aligned}
        0 &= T_0(0) = \theta_1 + \theta_3 \\
        1 &= T_0(1) = \theta_1 + \theta_2 + 2\theta_3 \\
        3 &= T_0(2) = \theta_1 + 2\theta_2 + 4\theta_3
    \end{aligned}
\]
Solving for above, we have
\[
    T(n) = -1 + n\times0 + 1 \times 2^n = -1 + 2^n
\]
\end{eg}

\section{Inhomogeneous Recurrences}